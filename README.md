# 微信朋友圈关系分析工具 专业版
一款基于 Python 的微信朋友圈社交网络分析工具，支持自动采集、互动关系挖掘、社区发现和可视化展示。

[功能特性](#功能特性) • [快速开始](#快速开始) • [使用指南](#使用指南) • [常见问题](#常见问题)

</div>

---

## 📋 目录

- [功能特性](#功能特性)
- [系统要求](#系统要求)
- [安装说明](#安装说明)
- [快速开始](#快速开始)
- [使用指南](#使用指南)
- [数据说明](#数据说明)
- [分析指标解读](#分析指标解读)
- [常见问题](#常见问题)
- [注意事项](#注意事项)
- [更新日志](#更新日志)

---

## ✨ 功能特性

### 核心功能

- **🔄 自动数据采集**
  - 无需手动操作，自动从微信桌面客户端采集朋友圈动态
  - 支持自定义采集数量和超时时间
  - 实时进度显示和日志记录
  - 采集内容包括：发布者、内容、时间、点赞、评论

- **📊 深度关系分析**
  - 基于点赞和评论构建互动网络图
  - 计算度中心性（活跃度指标）
  - 计算介数中心性（桥梁人物识别）
  - 自动社区检测（发现朋友圈小圈子）
  - 网络密度和互动强度统计

- **🎨 可视化展示**
  - 交互式网络关系图
  - 支持多种布局算法（弹簧、环形、Kamada-Kawai）
  - 节点大小、颜色、标签自定义
  - 选择特定人员查看其 1-3 级关系网络
  - 图表导出（PNG/PDF/SVG）

- **🔍 智能别名处理**
  - 自动识别相似名称（基于模糊匹配）
  - 可调节相似度阈值（推荐 0.85-0.90）
  - 一键应用别名映射
  - 提高分析准确度

- **💾 数据管理**
  - 支持 JSON 和 Excel 格式导入/导出
  - 节点数据批量导出
  - 完整的数据预览和编辑

---

## 🖥️ 系统要求

### 必需环境

| 组件 | 要求 |
|------|------|
| **操作系统** | Windows 7/8/10/11 (64位) |
| **Python 版本** | 3.7 或更高版本 |
| **微信客户端** | **3.9.10 版本**（必须） |
| **内存** | 建议 4GB 及以上 |
| **显示器分辨率** | 1280x720 或更高 |

### 微信客户端版本要求

⚠️ **重要提示**：本工具仅支持微信桌面客户端 **3.9.10 版本**。其他版本可能导致采集失败或功能异常。

**下载 3.9.10 版本：**
- 官方历史版本下载：[微信 Windows 版本历史](https://weixin.qq.com/)
- 备用下载链接：请自行搜索 "微信 3.9.10 版本下载"

**验证微信版本方法：**
1. 打开微信桌面客户端
2. 点击左下角 "三条横线" → "设置"
3. 点击 "关于微信"
4. 查看版本号是否为 3.9.10

---

## 📦 安装说明

### 方法一：使用 pip 安装（推荐）

```bash
# 1. 克隆或下载项目
git clone https://github.com/yourusername/wechat-moments-analysis.git
cd wechat-moments-analysis

# 2. 创建虚拟环境（推荐）
python -m venv venv
venv\Scripts\activate  # Windows

# 3. 安装依赖
pip install -r requirements.txt
```

### 方法二：手动安装依赖

```bash
pip install psutil pywinauto pandas networkx matplotlib openpyxl python-louvain rapidfuzz
```

### 依赖说明

| 库名 | 版本 | 用途 |
|------|------|------|
| psutil | ≥5.8.0 | 进程管理 |
| pywinauto | ≥0.6.8 | UI 自动化 |
| pandas | ≥1.3.0 | 数据处理 |
| networkx | ≥2.6.0 | 网络分析 |
| matplotlib | ≥3.4.0 | 可视化 |
| openpyxl | ≥3.0.0 | Excel 支持 |
| python-louvain | ≥0.15 | 社区检测 |
| rapidfuzz | ≥2.0.0 | 模糊匹配（可选） |

---

## 🚀 快速开始

### 第一步：启动程序

```bash
python main.py
```

程序启动后会显示主界面，包含数据展示区、分析结果日志和系统执行信息三个区域。

### 第二步：采集数据

1. **准备工作**
   - 确保微信桌面客户端（3.9.10 版本）已登录
   - 打开微信朋友圈页面
   - 保持朋友圈窗口可见（不要最小化）

2. **设置参数**
   - **采集数量**：建议 100-300 条（首次使用建议 100）
   - **超时时间**：建议 6-10 秒
   - **导出格式**：选择 JSON 或 Excel
   - **保存路径**：选择数据保存位置

3. **开始采集**
   - 点击 "开始采集" 按钮
   - 等待进度条完成（请勿操作微信窗口）
   - 采集完成后数据会自动显示在数据展示区

### 第三步：关系网分析

1. 点击 "关系网分析" 按钮
2. 等待分析完成（大约 10-30 秒）
3. 查看左侧"分析结果日志"区域的详细报告

### 第四步：查看关系图

1. 点击 "查看关系图" 按钮
2. 在弹出窗口中调整可视化参数：
   - **布局**：选择 spring（弹簧）、circular（环形）或 kamada_kawai
   - **节点大小**：调整节点显示大小
   - **显示标签**：是否显示人名
   - **显示连接线**：是否显示关系连线
3. **查看特定人员关系**：
   - 在"选择人员"列表中选择一个或多个人（支持 Ctrl/Shift 多选）
   - 选择"关系深度"（1=直接关系，2=朋友的朋友，3=三级关系）
   - 点击"生成图表"查看专属关系网络

---

## 📖 使用指南

### 别名处理功能

由于微信中可能存在昵称、备注名等差异，同一人可能有多个名称。别名功能帮助您统一这些名称。

**使用步骤：**

1. **运行别名建议**
   - 点击 "别名建议" 按钮
   - 输入相似度阈值（0-1）
     - 0.90+：非常严格，只匹配高度相似的名称
     - 0.85-0.90：推荐值，平衡准确性和覆盖率
     - <0.85：较宽松，可能产生误匹配

2. **查看建议结果**
   - 系统会列出所有相似名称对
   - 格式：`名称A  <->  名称B  (相似度: 0.xxx)`
   - 可保存为 JSON 文件备查

3. **应用别名映射**
   - 点击 "应用别名" 按钮
   - 系统自动将别名统一为较短的名称
   - 重新运行分析以查看效果

**示例：**
```
张三_备注名  <->  张三  (相似度: 0.92)
李四-公司    <->  李四  (相似度: 0.88)
```

### 数据导入/导出

**支持的格式：**

1. **JSON 格式**（推荐）
   - 保留完整的评论列表信息
   - 文件体积较小
   - 适合程序间数据交换

2. **Excel 格式**
   - 便于人工查看和编辑
   - 适合后续数据分析
   - 注意：评论会被转换为字符串

**导入步骤：**
1. 点击 "导入数据" 按钮
2. 选择 JSON 或 Excel 文件
3. 数据自动加载到数据展示区

**导出步骤：**
1. 采集或分析完成后
2. 数据已自动保存到指定路径
3. 也可使用 "查看关系图" 中的导出功能

---

## 📊 数据说明

### 采集数据结构

每条朋友圈动态包含以下字段：

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| 编号 | Integer | 序号 | 1, 2, 3... |
| 发布者 | String | 发布人昵称/备注 | "张三" |
| 内容 | String | 朋友圈文字内容 | "今天天气真好！" |
| 时间 | String | 发布时间 | "今天"、"昨天"、"12月18日" |
| 点赞 | String | 点赞者列表（逗号分隔） | "李四，王五，赵六" |
| 评论 | List | 评论列表 | ["李四: 真不错", "王五: 同感"] |

### 数据示例

**JSON 格式：**
```json
[
  {
    "编号": 1,
    "发布者": "张三",
    "内容": "分享一张美图",
    "时间": "今天",
    "点赞": "李四，王五，赵六",
    "评论": [
      "李四: 拍得真好！",
      "王五: 在哪里拍的？"
    ]
  }
]
```

---

## 📈 分析指标解读

### 网络基本指标

**1. 参与人数（节点数）**
- 定义：所有参与互动的用户总数（包括发布者、点赞者、评论者）
- 意义：反映您朋友圈的活跃人数规模

**2. 互动关系总数（边数）**
- 定义：所有点赞和评论形成的关系连接数
- 计算：每次点赞或评论都会在两人之间建立一条边
- 意义：边数越多，互动越频繁

**3. 网络密度**
- 定义：实际存在的关系数 / 理论最大关系数
- 取值范围：0-1
- 意义：
  - 接近 1：朋友圈成员之间联系紧密，形成"小世界"
  - 接近 0：成员相对独立，分组明显

**4. 平均互动强度**
- 定义：所有关系的平均权重
- 权重计算：点赞权重 = 1，评论权重 = 2
- 意义：数值越高，互动越深入

### 中心性指标

**1. 度中心性（Degree Centrality）**
- 定义：一个人与多少人有互动关系
- 计算：连接数 / (总人数 - 1)
- 排名意义：
  - 第一名：朋友圈最活跃的人
  - 高分者：社交广泛，人脉丰富

**2. 介数中心性（Betweenness Centrality）**
- 定义：一个人在网络中担任"桥梁"的程度
- 计算：经过该节点的最短路径数量
- 排名意义：
  - 高分者：连接不同圈子的"桥梁人物"
  - 典型角色：班长、组织者、多圈子活跃者

### 社区检测结果

**社区的定义：**
- 社区内成员之间互动频繁
- 社区间成员互动较少
- 通常代表"现实生活中的小圈子"

**典型社区类型：**
- 同学圈：大学同学、高中同学
- 同事圈：公司同事、行业伙伴
- 家人圈：亲戚、家族成员
- 兴趣圈：共同爱好者（摄影、旅游等）

**如何理解社区编号：**
- 社区按规模排序（社区 1 最大，社区 2 次之）
- 同一社区成员往往有共同特征
- 可结合实际关系验证准确性

---

## ❓ 常见问题

### 采集相关

**Q1: 提示"未检测到 WeChat.exe 进程"**
- **原因**：微信未运行或进程名称不匹配
- **解决**：
  1. 确认微信桌面客户端已打开并登录
  2. 确认是 3.9.10 版本
  3. 检查任务管理器中是否有 WeChat.exe

**Q2: 提示"无法定位朋友圈窗口"**
- **原因**：朋友圈页面未打开或窗口最小化
- **解决**：
  1. 在微信中点击"朋友圈"，确保窗口显示
  2. 不要最小化朋友圈窗口
  3. 确保窗口标题包含"朋友圈"字样

**Q3: 采集数量远少于目标数量**
- **原因**：超时时间过短或已滚动到底部
- **解决**：
  1. 增加超时时间（建议 8-10 秒）
  2. 朋友圈动态较少时会自动停止
  3. 检查网络连接是否正常

**Q4: 采集过程中卡住不动**
- **原因**：微信窗口被遮挡或系统资源不足
- **解决**：
  1. 确保朋友圈窗口完全可见
  2. 关闭其他占用资源的程序
  3. 重启程序后重新采集

### 分析相关

**Q5: 分析结果中同一人出现多个名字**
- **原因**：微信昵称与备注名不同
- **解决**：使用"别名建议"和"应用别名"功能

**Q6: 社区检测结果不准确**
- **原因**：数据量不足或互动关系稀疏
- **建议**：
  1. 采集更多数据（建议 200+ 条）
  2. 结合实际关系人工验证
  3. 社区检测是统计学方法，存在一定误差

**Q7: 某些用户点赞或评论未显示**
- **原因**：微信 UI 元素识别限制
- **说明**：
  1. 工具已尽力提取，但可能有遗漏
  2. 复杂格式（回复、表情）可能解析不完整
  3. 不影响整体分析趋势

### 技术问题

**Q8: 安装依赖时报错**
- **解决**：
  ```bash
  # 使用国内镜像源
  pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r requirements.txt
  
  # 或逐个安装
  pip install psutil pywinauto pandas networkx matplotlib
  ```

**Q9: 运行时提示缺少模块**
- **解决**：
  ```bash
  # 安装缺失的模块
  pip install python-louvain rapidfuzz openpyxl
  ```

**Q10: 图表显示中文乱码**
- **原因**：字体配置问题
- **解决**：代码已自动配置 SimHei 和 Microsoft YaHei，通常无需处理

---

## ⚠️ 注意事项

### 法律与隐私

1. **数据使用规范**
   - ✅ 仅分析您有权访问的个人朋友圈数据
   - ✅ 用于个人研究和学习目的
   - ❌ 禁止传播、公开、商业使用他人数据
   - ❌ 禁止未经授权采集他人信息

2. **隐私保护建议**
   - 导出的数据文件妥善保管
   - 不要上传到公共平台
   - 分享截图时注意打码敏感信息

3. **合规声明**
   - 本工具仅供技术研究学习
   - 使用者需遵守《中华人民共和国网络安全法》
   - 使用者需遵守《微信软件许可及服务协议》

### 技术限制

1. **平台限制**
   - 仅支持 Windows 系统
   - 仅支持微信 3.9.10 桌面版
   - 不支持网页版或手机端

2. **采集限制**
   - 仅能采集可见朋友圈（根据隐私设置）
   - 无法采集已删除的历史动态
   - 采集速度受网络和设备性能影响

3. **分析限制**
   - 社区检测基于统计算法，可能不完全准确
   - 大规模数据（10000+ 条）可能需要较长时间
   - 部分复杂互动格式可能解析不完整

---

## 🔄 更新日志

### Version 4.0 (2025-12-18)

**新增功能：**
- ✨ 支持选择特定人员查看其 1-3 级关系网络
- ✨ 关系图支持多人同时选择（Ctrl/Shift 多选）
- ✨ 新增全选/取消全选按钮，方便批量操作
- ✨ 人员列表增加滚动条，优化大量数据显示
- ✨ 过滤掉包含"回复"字样的无效节点
- ✨ 改进关系图标题，动态显示选中人员信息

**优化改进：**
- 🔧 优化网络图布局算法
- 🔧 改进介数中心性计算（大规模数据使用采样）
- 🔧 优化 UI 布局和字体显示
- 🔧 增强错误处理和日志记录

**Bug 修复：**
- 🐛 修复部分点赞者名称解析问题
- 🐛 修复评论格式异常导致的崩溃
- 🐛 修复进度条显示异常

### Version 3.0 (2024-10-11)
- 初始发布版本

---

## 📞 支持与反馈

### 获取帮助

- **使用手册**：点击软件中的"使用手册"按钮
- **问题反馈**：提交 GitHub Issue
- **功能建议**：欢迎提交 Pull Request

### 开发者信息

- **Author**: PanDa
- **Version**: 4.0
- **Date**: 2025-10-08
- **License**: MIT

---

## 📄 许可证

本项目采用 MIT 许可证。详见 [LICENSE](LICENSE) 文件。

---

<div align="center">

**如果这个项目对您有帮助，请给一个 ⭐ Star！**

Made with ❤️ by PGX

</div>
